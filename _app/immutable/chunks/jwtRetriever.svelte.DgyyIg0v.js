import{P as i}from"./public.CuSQJZaf.js";import{s as t}from"./shared.svelte.BeaxiWn1.js";function n(){var a;return document.cookie?((a=document.cookie.split("; ").find(o=>o.startsWith("jwt=")))==null?void 0:a.split("=")[1])??null:null}function c(e){const a=e.split(".")[1];return JSON.parse(atob(a)).exp*1e3}function r(e){return c(e)<Date.now()}function l(){const e=n();return e?r(e)?(t.isLoggedIn=!1,u(),!1):(t.isLoggedIn=!0,t.cachedUserData===null&&s(),!0):(t.isLoggedIn=!1,!1)}function h(e){document.cookie=`jwt=${e}; path=/; Secure`,s()}function u(){document.cookie="jwt=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",t.isLoggedIn=!1,t.cachedUserData=null}async function s(){const e=await fetch(i+"/private-user-info",{method:"GET",headers:{Authorization:"Bearer "+n()}}),a=await e.json();e.ok&&(t.cachedUserData=a)}async function w(){const e=await fetch(i+"/notifications",{method:"GET",headers:{Authorization:"Bearer "+n()}}),a=await e.json();if(e.status===200){if(a.length>0&&t.cachedUserData&&(t.cachedUserData.lastNotificationsSeenAt===null||t.cachedUserData.lastNotificationsSeenAt!==null&&new Date(a[0].creationDateTime)>new Date(t.cachedUserData.lastNotificationsSeenAt)))return!0;t.cachedUserData&&t.cachedUserData.lastNotificationsSeenAt&&console.log("1",new Date(a[0].creationDateTime),"2",new Date(t.cachedUserData.lastNotificationsSeenAt))}return!1}export{s as c,w as h,l as i,n as j,u as l,h as s};
