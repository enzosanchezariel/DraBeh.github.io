import{c as P,a as y,t as E}from"../chunks/disclose-version.7XzoFcgQ.js";import{p as F,f as A,a as J,i as t,s,c as n,j as e,t as B,k,r as l}from"../chunks/runtime.CcS7PSai.js";import{d as R,e as I}from"../chunks/render.CfWg8y1S.js";import{i as x}from"../chunks/if.Bc-vB0Lk.js";import{s as K}from"../chunks/attributes.B2B5KGyN.js";import{s as V}from"../chunks/style.PwPRnE0L.js";import{t as h,f as w}from"../chunks/index.D4VyEPYp.js";import{g as z}from"../chunks/entry.CftrLipe.js";import{a as G,P as L}from"../chunks/public.CuSQJZaf.js";import{E as O}from"../chunks/ErrorArticle.onCvV9Yg.js";import"../chunks/shared.svelte.MLCOWDAd.js";var H=E('<div><article><strong>Recover account</strong> <footer><form><label for="email">Email</label> <input type="email" id="email" name="email" required> <button type="submit">Send recovery code</button></form> <!></footer></article> <p>You had a membership or a special role and have trouble recovering your account? <a>Send an email over here.</a></p></div>'),Q=(D,C,a)=>{e(C,!0),e(a,0)},W=E('<article><strong>Change your password</strong> <footer><p>Enter the verification code that has been sent to your email.   <a>Is the email incorrect?</a></p> <form><label for="code">Verification code</label> <input type="text" id="code" name="code" required> <label for="password">Password</label> <input type="password" id="password" name="password" required> <label for="password-confirm">Confirm password</label> <input type="password" id="password-confirm" name="password-confirm" required> <button type="submit">Send recovery code</button></form> <!></footer></article>'),X=()=>{z("/account/login")},Z=E('<article><strong>Password changed</strong> <footer><p>Your password has been verified successfully</p> <button type="submit">Accept</button></footer></article>');function de(D,C){F(C,!0);let a=k(!1),u=k(""),_=k(0),b=k(!1),d=k(!1);async function j(f){e(b,!0),f.preventDefault();const r=new FormData(f.target),m={email:r.get("email")};try{(await fetch(L+"/recover",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)})).ok?(e(a,!1),e(d,!1),T=r.get("email"),e(_,1)):(e(u,"An error occurred."),e(a,!0))}catch{e(u,"Couldn't connect to the server."),e(a,!0)}e(b,!1)}let T;async function M(f){e(b,!0),f.preventDefault();const r=new FormData(f.target),m={email:T,recoveryCode:r.get("code"),password:r.get("password")};if(r.get("password")===r.get("password-confirm"))try{(await fetch(L+"/recover/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)})).ok?(e(a,!1),e(d,!1),e(_,2)):(e(u,"An error occurred."),e(a,!0))}catch{e(u,"Couldn't connect to the server."),e(a,!0)}else e(u,"Passwords do not match."),e(a,!0);e(b,!1)}var q=P(),N=A(q);x(N,()=>t(_)===0,f=>{var r=H(),m=n(r),c=s(n(m),2),o=n(c),g=s(n(o),4);l(o);var v=s(o,2);x(v,()=>t(a),S=>{O(S,{get text(){return t(u)},removeAction:()=>{e(a,!1)}})}),l(c),l(m);var i=s(m,2),p=s(n(i));K(p,"href","mailto:"+G),l(i),l(r),B(()=>g.disabled=t(b)),I("submit",o,j),h(1,r,()=>w,()=>({x:t(d)?-1e3:1e3,duration:500,delay:500})),h(2,r,()=>w,()=>({x:t(d)?1e3:-1e3,duration:500})),y(f,r)},f=>{var r=P(),m=A(r);x(m,()=>t(_)===1,c=>{var o=W(),g=s(n(o),2),v=n(g),i=s(n(v));i.__click=[Q,d,_],V(i,"cursor","pointer"),l(v);var p=s(v,2),S=s(n(p),12);l(p);var U=s(p,2);x(U,()=>t(a),Y=>{O(Y,{get text(){return t(u)},removeAction:()=>{e(a,!1)}})}),l(g),l(o),B(()=>S.disabled=t(b)),I("submit",p,M),h(1,o,()=>w,()=>({x:t(d)?-1e3:1e3,duration:500,delay:500})),h(2,o,()=>w,()=>({x:t(d)?1e3:-1e3,duration:500})),y(c,o)},c=>{var o=P(),g=A(o);x(g,()=>t(_)===2,v=>{var i=Z(),p=s(n(i),2),S=s(n(p),2);S.__click=[X],l(p),l(i),h(1,i,()=>w,()=>({x:t(d)?-1e3:1e3,duration:500,delay:500})),h(2,i,()=>w,()=>({x:t(d)?1e3:-1e3,duration:500})),y(v,i)},null,!0),y(c,o)},!0),y(f,r)}),y(D,q),J()}R(["click"]);export{de as component};
