import{c as R,a as f,t as S}from"../chunks/disclose-version.D9m7xwQo.js";import{p as re,f as V,a as oe,i as s,s as e,c,t as se,j as a,k as u,r as l}from"../chunks/runtime.DfkX_MRI.js";import{d as ne,e as g}from"../chunks/render.C_RUzaBA.js";import{i as y}from"../chunks/if.Che8I7_Z.js";import{s as $,r as I}from"../chunks/attributes.Dy5-VJ7D.js";import{t as v,f as C,s as F}from"../chunks/index.BZ_PEADJ.js";import{b as H,c as ie}from"../chunks/input.DziYSjDK.js";import{p as ce}from"../chunks/proxy.DjRACbVb.js";import{P as K}from"../chunks/public.CuSQJZaf.js";import{E as le}from"../chunks/ErrorArticle.DqpzrGdp.js";import{g as pe}from"../chunks/entry.B_5C_Fe6.js";import{s as de,i as ue}from"../chunks/jwtRetriever.svelte.DgyyIg0v.js";import{b as N}from"../chunks/paths.BDr6tJJm.js";var me=S('<p class="svelte-vevk28">How you want to be called</p>'),fe=S('<p class="svelte-vevk28">Unique to identify your account (cannot contain spaces)</p>'),ve=S('<div><article><strong>Create an account</strong> <footer><form><div class="tip svelte-vevk28"><label for="nickname">Nickname</label> <input type="text" id="nickname" name="nickname" required class="svelte-vevk28"> <!></div> <div class="tip svelte-vevk28"><label for="username">Username</label> <input type="text" id="username" name="username" required class="svelte-vevk28"> <!></div> <label for="password">Password</label> <input type="password" id="password" name="password" required> <label for="password-confirm">Confirm password</label> <input type="password" id="password-confirm" name="password-confirm" required> <input type="checkbox" id="ua"> <label for="ua"><p>I accept the <a>terms and conditions.</a></p></label> <button type="submit">Register</button></form> <!></footer></article> <p>Already have an account? <a>Log in</a></p></div>'),be=()=>{pe(N+"/home")},_e=S('<article><strong>Account created successfully</strong> <footer><p>Welcome to DraBeh!</p> <button type="submit">Accept</button></footer></article>');function Te(W,z){re(z,!0);let P=u(-1);function h(p){a(P,ce(p))}let q=u(""),w=u(""),b=u(""),d=u(!1),D=u(0);async function G(p){p.preventDefault();const t=new FormData(p.target);if(t.get("password")===t.get("password-confirm")){const n={username:t.get("username"),nickname:t.get("nickname"),password:t.get("password")};try{const r=await fetch(K+"/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});r.ok?(a(d,!1),a(D,1),M(n.username,n.password)):r.status===409?(a(b,"The username is already taken."),a(d,!0)):(a(b,"An error occurred."),a(d,!0))}catch{a(b,"Couldn't connect to the server."),a(d,!0)}}else a(q,""),a(b,"Passwords do not match."),a(d,!0)}async function M(p,t){const n={username:p,password:t};try{const r=await fetch(K+"/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(r.ok){a(d,!1);const o=await r.text();de(o),ue()}}catch{}}let L=u(!1);var O=R(),Q=V(O);y(Q,()=>s(D)===0,p=>{var t=ve(),n=c(t),r=e(c(n),2),o=c(r),m=c(o),k=e(c(m),2),X=e(k,2);y(X,()=>s(P)===0,i=>{var _=me();v(3,_,()=>F,()=>({axis:"y",duration:500})),f(i,_)}),l(m);var T=e(m,2),x=e(c(T),2);I(x);var Y=e(x,2);y(Y,()=>s(P)===1,i=>{var _=fe();v(3,_,()=>F,()=>({axis:"y",duration:500})),f(i,_)}),l(T);var U=e(T,4),A=e(U,4);I(A);var j=e(A,2);I(j);var E=e(j,2),B=c(E),Z=e(c(B));$(Z,"href",`${N??""}/about/help/user-agreement`),l(B),l(E);var ee=e(E,2);se(()=>ee.disabled=s(w)===""||s(w).includes(" ")||!s(L)),l(o);var ae=e(o,2);y(ae,()=>s(d),i=>{le(i,{get text(){return s(b)},removeAction:()=>{a(d,!1)}})}),l(r),l(n);var J=e(n,2),te=e(c(J));$(te,"href",`${N??""}/account/login`),l(J),l(t),g("submit",o,G),g("focus",k,()=>h(0)),g("focus",x,()=>h(1)),H(x,()=>s(w),i=>a(w,i)),g("focus",U,()=>h(2)),g("focus",A,()=>h(3)),H(A,()=>s(q),i=>a(q,i)),ie(j,()=>s(L),i=>a(L,i)),v(1,t,()=>C,()=>({x:1e3,duration:500,delay:500})),v(2,t,()=>C,()=>({x:-1e3,duration:500})),f(p,t)},p=>{var t=R(),n=V(t);y(n,()=>s(D)===1,r=>{var o=_e(),m=e(c(o),2),k=e(c(m),2);k.__click=[be],l(m),l(o),v(1,o,()=>C,()=>({x:1e3,duration:500,delay:500})),v(2,o,()=>C,()=>({x:-1e3,duration:500})),f(r,o)},null,!0),f(p,t)}),f(W,O),oe()}ne(["click"]);export{Te as component};
