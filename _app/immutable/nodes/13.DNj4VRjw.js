import{a as S,t as j}from"../chunks/disclose-version.CLVP8wdO.js";import{p as k,g as I,a as U,j as r,s as a,c as n,i as w,k as h,r as i}from"../chunks/runtime.OFQIcp2P.js";import{e as q}from"../chunks/render.BVhLVIDF.js";import{i as B}from"../chunks/if.CxsERAfj.js";import{s as y}from"../chunks/attributes.CGWwtoYz.js";import{o as F}from"../chunks/index-client.DzRFANZT.js";import{P as J}from"../chunks/public.CHZCeYTi.js";import{i as _,s as N}from"../chunks/jwtRetriever.svelte.eYKYCOXx.js";import{g as D}from"../chunks/entry.JVcXWMU4.js";import"../chunks/shared.svelte.Crem28hc.js";import{E as O}from"../chunks/ErrorArticle.Djy6cXaC.js";import{b as m}from"../chunks/paths.Dxl4Naed.js";var R=j(`<article><strong>Login</strong> <footer><form><label for="username">Username</label> <input type="text" id="username" name="username" required> <label for="password">Password</label> <input type="password" id="password" name="password" required> <button type="submit">Login</button></form> <!></footer></article> <p>Don't have an account yet? <a>Sign up.</a></p> <p>Forgot your password? <a>Recover account.</a></p>`,1);function Z(L,x){k(x,!0);let t=h(""),e=h(!1);F(()=>{_()&&(r(t,"You are already logged in."),r(e,!0))});async function A(o){o.preventDefault();const g=new FormData(o.target),b={username:g.get("username"),password:g.get("password")};try{const s=await fetch(J+"/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!s.ok)s.status===401?r(t,"Invalid username or password."):r(t,"An error occurred."),r(e,!0);else{r(e,!1);const v=await s.text();v==="banned"?D(m+"/about/ban?username="+b.username):(N(v),_(),D(m+"/home"))}}catch{r(t,"Couldn't connect to the server."),r(e,!0)}}var f=R(),p=I(f),c=a(n(p),2),l=n(c),C=a(l,2);B(C,()=>w(e),o=>{O(o,{get text(){return w(t)},removeAction:()=>{r(e,!1)}})}),i(c),i(p);var u=a(p,2),E=a(n(u));y(E,"href",`${m??""}/account/register`),i(u);var d=a(u,2),P=a(n(d));y(P,"href",`${m??""}/account/recover`),i(d),q("submit",l,A),S(L,f),U()}export{Z as component};
