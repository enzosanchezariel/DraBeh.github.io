import{c as A,a as m,t as k}from"../chunks/disclose-version.7XzoFcgQ.js";import{p as P,f as x,a as S,i as l,s as c,c as s,j as o,t as I,k as d,r as n,l as O}from"../chunks/runtime.CcS7PSai.js";import{d as R,e as T}from"../chunks/render.CfWg8y1S.js";import{i as w}from"../chunks/if.Bc-vB0Lk.js";import{t as f,f as v}from"../chunks/index.D4VyEPYp.js";import{o as U}from"../chunks/index-client.DhXnJF1D.js";import{g as C}from"../chunks/entry.CftrLipe.js";import{P as Y}from"../chunks/public.CuSQJZaf.js";import{E as q}from"../chunks/ErrorArticle.onCvV9Yg.js";import{i as z,j as F,l as K}from"../chunks/jwtRetriever.svelte.D-u_pXbS.js";var M=k(`<div><article><strong>Confirm account deletion</strong> <footer><form class="form svelte-1ey8vcm"><label for="password">Confirm your password</label> <input type="password" id="password" name="password" required> <button type="submit" class="svelte-1ey8vcm">Delete</button></form> <!></footer></article> <p>All your user data will be removed (comments, posts, drawings, email, username).</p> <p>Once you delete your account, you won't be able to recover it.</p> <p>You won't be able to delete your account while it is under review due to a report.</p></div>`),N=()=>{C("/")},G=k('<article><strong>Account deleted</strong> <footer><p>Your account has been deleted successfully</p> <button type="submit">Accept</button></footer></article>');function oe(D,j){P(j,!0);let b=d(!1),i=d(!1),g=d(""),y=d(0);U(()=>{z()||C("/account/login",{replaceState:!0})});async function E(r){o(b,!0),r.preventDefault();const e=new FormData(r.target);try{(await fetch(Y+"/delete-account",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+F()},body:e.get("password")})).ok?(o(i,!1),K(),o(y,1)):(o(g,"An error occurred."),o(i,!0))}catch{o(g,"Couldn't connect to the server."),o(i,!0)}o(b,!1)}var h=A(),B=x(h);w(B,()=>l(y)===0,r=>{var e=M(),a=s(e),u=c(s(a),2),t=s(u),p=c(s(t),4);n(t);var _=c(t,2);w(_,()=>l(i),L=>{q(L,{get text(){return l(g)},removeAction:()=>{o(i,!1)}})}),n(u),n(a),O(6),n(e),I(()=>p.disabled=l(b)),T("submit",t,E),f(1,e,()=>v,()=>({x:1e3,duration:500,delay:500})),f(2,e,()=>v,()=>({x:-1e3,duration:500})),m(r,e)},r=>{var e=A(),a=x(e);w(a,()=>l(y)===1,u=>{var t=G(),p=c(s(t),2),_=c(s(p),2);_.__click=[N],n(p),n(t),f(1,t,()=>v,()=>({x:1e3,duration:500,delay:500})),f(2,t,()=>v,()=>({x:-1e3,duration:500})),m(u,t)},null,!0),m(r,e)}),m(D,h),S()}R(["click"]);export{oe as component};
