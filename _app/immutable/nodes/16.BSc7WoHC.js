import{c as O,a as f,t as S}from"../chunks/disclose-version.7XzoFcgQ.js";import{p as X,f as U,a as Y,i as s,s as a,c as p,t as Z,j as e,k as u,r as d,l as $}from"../chunks/runtime.CcS7PSai.js";import{d as ee,e as _}from"../chunks/render.CfWg8y1S.js";import{i as y}from"../chunks/if.Bc-vB0Lk.js";import{r as E}from"../chunks/attributes.B2B5KGyN.js";import{t as v,f as C,s as B}from"../chunks/index.D4VyEPYp.js";import{b as J,c as te}from"../chunks/input.RtaRc4WU.js";import{p as ae}from"../chunks/proxy.DTRB1kLB.js";import{P as R}from"../chunks/public.CuSQJZaf.js";import{E as re}from"../chunks/ErrorArticle.onCvV9Yg.js";import{g as oe}from"../chunks/entry.CftrLipe.js";import{s as se,i as ne}from"../chunks/jwtRetriever.svelte.D-u_pXbS.js";var ie=S('<p class="svelte-vevk28">How you want to be called</p>'),ce=S('<p class="svelte-vevk28">Unique to identify your account (cannot contain spaces)</p>'),le=S('<div><article><strong>Create an account</strong> <footer><form><div class="tip svelte-vevk28"><label for="nickname">Nickname</label> <input type="text" id="nickname" name="nickname" required class="svelte-vevk28"> <!></div> <div class="tip svelte-vevk28"><label for="username">Username</label> <input type="text" id="username" name="username" required class="svelte-vevk28"> <!></div> <label for="password">Password</label> <input type="password" id="password" name="password" required> <label for="password-confirm">Confirm password</label> <input type="password" id="password-confirm" name="password-confirm" required> <input type="checkbox" id="ua"> <label for="ua"><p>I accept the <a href="/about/help/user-agreement">terms and conditions.</a></p></label> <button type="submit">Register</button></form> <!></footer></article> <p>Already have an account? <a href="/account/login">Log in</a></p></div>'),pe=()=>{oe("/home")},de=S('<article><strong>Account created successfully</strong> <footer><p>Welcome to DraBeh!</p> <button type="submit">Accept</button></footer></article>');function Ae(V,F){X(F,!0);let P=u(-1);function h(i){e(P,ae(i))}let q=u(""),w=u(""),g=u(""),l=u(!1),D=u(0);async function H(i){i.preventDefault();const t=new FormData(i.target);if(t.get("password")===t.get("password-confirm")){const c={username:t.get("username"),nickname:t.get("nickname"),password:t.get("password")};try{const r=await fetch(R+"/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});r.ok?(e(l,!1),e(D,1),K(c.username,c.password)):r.status===409?(e(g,"The username is already taken."),e(l,!0)):(e(g,"An error occurred."),e(l,!0))}catch{e(g,"Couldn't connect to the server."),e(l,!0)}}else e(q,""),e(g,"Passwords do not match."),e(l,!0)}async function K(i,t){const c={username:i,password:t};try{const r=await fetch(R+"/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(r.ok){e(l,!1);const o=await r.text();se(o),ne()}}catch{}}let L=u(!1);var I=O(),W=U(I);y(W,()=>s(D)===0,i=>{var t=le(),c=p(t),r=a(p(c),2),o=p(r),m=p(o),k=a(p(m),2),z=a(k,2);y(z,()=>s(P)===0,n=>{var b=ie();v(3,b,()=>B,()=>({axis:"y",duration:500})),f(n,b)}),d(m);var T=a(m,2),x=a(p(T),2);E(x);var G=a(x,2);y(G,()=>s(P)===1,n=>{var b=ce();v(3,b,()=>B,()=>({axis:"y",duration:500})),f(n,b)}),d(T);var N=a(T,4),A=a(N,4);E(A);var j=a(A,2);E(j);var M=a(j,4);Z(()=>M.disabled=s(w)===""||s(w).includes(" ")||!s(L)),d(o);var Q=a(o,2);y(Q,()=>s(l),n=>{re(n,{get text(){return s(g)},removeAction:()=>{e(l,!1)}})}),d(r),d(c),$(2),d(t),_("submit",o,H),_("focus",k,()=>h(0)),_("focus",x,()=>h(1)),J(x,()=>s(w),n=>e(w,n)),_("focus",N,()=>h(2)),_("focus",A,()=>h(3)),J(A,()=>s(q),n=>e(q,n)),te(j,()=>s(L),n=>e(L,n)),v(1,t,()=>C,()=>({x:1e3,duration:500,delay:500})),v(2,t,()=>C,()=>({x:-1e3,duration:500})),f(i,t)},i=>{var t=O(),c=U(t);y(c,()=>s(D)===1,r=>{var o=de(),m=a(p(o),2),k=a(p(m),2);k.__click=[pe],d(m),d(o),v(1,o,()=>C,()=>({x:1e3,duration:500,delay:500})),v(2,o,()=>C,()=>({x:-1e3,duration:500})),f(r,o)},null,!0),f(i,t)}),f(V,I),Y()}ee(["click"]);export{Ae as component};
