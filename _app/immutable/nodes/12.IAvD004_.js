import{c as A,a as p,t as k}from"../chunks/disclose-version.CLVP8wdO.js";import{p as S,g as x,a as I,i as l,s as c,c as s,j as o,t as O,k as d,r as n,l as R}from"../chunks/runtime.OFQIcp2P.js";import{d as T,e as U}from"../chunks/render.BVhLVIDF.js";import{i as w}from"../chunks/if.CxsERAfj.js";import{t as f,f as v}from"../chunks/index.xyXJjMDu.js";import{o as Y}from"../chunks/index-client.DzRFANZT.js";import{g as C}from"../chunks/entry.DMoyRBBC.js";import{b as D}from"../chunks/paths.CWjIHuvM.js";import{P as q}from"../chunks/public.CHZCeYTi.js";import{E as z}from"../chunks/ErrorArticle.Djy6cXaC.js";import{i as F,j as K,l as M}from"../chunks/jwtRetriever.svelte.eYKYCOXx.js";var N=k(`<div><article><strong>Confirm account deletion</strong> <footer><form class="form svelte-1ey8vcm"><label for="password">Confirm your password</label> <input type="password" id="password" name="password" required> <button type="submit" class="svelte-1ey8vcm">Delete</button></form> <!></footer></article> <p>All your user data will be removed (comments, posts, drawings, email, username).</p> <p>Once you delete your account, you won't be able to recover it.</p> <p>You won't be able to delete your account while it is under review due to a report.</p></div>`),G=()=>{C(D+"/")},H=k('<article><strong>Account deleted</strong> <footer><p>Your account has been deleted successfully</p> <button type="submit">Accept</button></footer></article>');function ae(j,E){S(E,!0);let b=d(!1),i=d(!1),g=d(""),y=d(0);Y(()=>{F()||C(D+"/account/login",{replaceState:!0})});async function B(r){o(b,!0),r.preventDefault();const e=new FormData(r.target);try{(await fetch(q+"/delete-account",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+K()},body:e.get("password")})).ok?(o(i,!1),M(),o(y,1)):(o(g,"An error occurred."),o(i,!0))}catch{o(g,"Couldn't connect to the server."),o(i,!0)}o(b,!1)}var h=A(),L=x(h);w(L,()=>l(y)===0,r=>{var e=N(),a=s(e),u=c(s(a),2),t=s(u),m=c(s(t),4);n(t);var _=c(t,2);w(_,()=>l(i),P=>{z(P,{get text(){return l(g)},removeAction:()=>{o(i,!1)}})}),n(u),n(a),R(6),n(e),O(()=>m.disabled=l(b)),U("submit",t,B),f(1,e,()=>v,()=>({x:1e3,duration:500,delay:500})),f(2,e,()=>v,()=>({x:-1e3,duration:500})),p(r,e)},r=>{var e=A(),a=x(e);w(a,()=>l(y)===1,u=>{var t=H(),m=c(s(t),2),_=c(s(m),2);_.__click=[G],n(m),n(t),f(1,t,()=>v,()=>({x:1e3,duration:500,delay:500})),f(2,t,()=>v,()=>({x:-1e3,duration:500})),p(u,t)},null,!0),p(r,e)}),p(j,h),I()}T(["click"]);export{ae as component};
