import{c as k,a as m,t as x}from"../chunks/disclose-version.D9m7xwQo.js";import{p as B,f as P,a as L,i as d,s as l,c as i,j as e,t as N,k as u,r as p}from"../chunks/runtime.DfkX_MRI.js";import{d as R,e as I}from"../chunks/render.C_RUzaBA.js";import{i as _}from"../chunks/if.Che8I7_Z.js";import{t as w,f as g}from"../chunks/index.BZ_PEADJ.js";import{o as O}from"../chunks/index-client.D7pkVx_0.js";import{g as A}from"../chunks/entry.BIT9139B.js";import{b as C}from"../chunks/paths.DkE6e-OB.js";import{P as T}from"../chunks/public.CuSQJZaf.js";import{E as U}from"../chunks/ErrorArticle.DqpzrGdp.js";import{i as Y,j as z,l as F}from"../chunks/jwtRetriever.svelte.DgyyIg0v.js";var J=x('<div><article><strong>Recover account</strong> <footer><form><label for="password">Current password</label> <input type="password" id="password" name="password" required> <hr> <label for="new-password">New password</label> <input type="password" id="new-password" name="new-password" required> <label for="new-password-confirm">Confirm new password</label> <input type="password" id="new-password-confirm" name="new-password-confirm" required> <button type="submit">Save changes</button></form> <!></footer></article></div>'),K=()=>{A(C+"/account/login")},M=x('<article><strong>Password changed</strong> <footer><p>Your password has been changed successfully</p> <p>You will have to log back in for security purposes.</p> <button type="submit">Accept</button></footer></article>');function tr(S,j){B(j,!0);let t=u(!1),c=u(""),v=u(0),b=u(!1);O(()=>{Y()||A(C+"/account/login",{replaceState:!0})});async function D(a){e(b,!0),a.preventDefault();const r=new FormData(a.target),s={password:r.get("password"),newPassword:r.get("new-password")};if(r.get("new-password")===r.get("new-password-confirm"))try{(await fetch(T+"/change-password",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+z()},body:JSON.stringify(s)})).ok?(e(t,!1),e(v,1),F()):(e(c,"An error occurred."),e(t,!0))}catch{e(c,"Couldn't connect to the server."),e(t,!0)}else e(c,"Passwords do not match."),e(t,!0);e(b,!1)}var y=k(),E=P(y);_(E,()=>d(v)===0,a=>{var r=J(),s=i(r),n=l(i(s),2),o=i(n),f=l(i(o),14);p(o);var h=l(o,2);_(h,()=>d(t),q=>{U(q,{get text(){return d(c)},removeAction:()=>{e(t,!1)}})}),p(n),p(s),p(r),N(()=>f.disabled=d(b)),I("submit",o,D),w(1,r,()=>g,()=>({x:1e3,duration:500,delay:500})),w(2,r,()=>g,()=>({x:-1e3,duration:500})),m(a,r)},a=>{var r=k(),s=P(r);_(s,()=>d(v)===1,n=>{var o=M(),f=l(i(o),2),h=l(i(f),4);h.__click=[K],p(f),p(o),w(1,o,()=>g,()=>({x:1e3,duration:500,delay:500})),w(2,o,()=>g,()=>({x:-1e3,duration:500})),m(n,o)},null,!0),m(a,r)}),m(S,y),L()}R(["click"]);export{tr as component};
